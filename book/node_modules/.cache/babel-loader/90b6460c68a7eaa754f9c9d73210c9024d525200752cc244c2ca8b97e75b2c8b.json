{"ast":null,"code":"var _s = $RefreshSig$();\n// frontend/src/pages/ProfilePage.js\nimport React, { useState, useEffect, useCallback } from 'react'; // Keep useCallback\nimport axios from 'axios';\nimport { toast } from 'react-toastify';\nimport { useAuth } from '../contexts/AuthContext';\nimport '../components/Form.css';\nimport '../App.css';\nfunction ProfilePage() {\n  _s();\n  const {\n    user: authUser,\n    token,\n    logout\n  } = useAuth(); // Renamed 'user' to 'authUser' to avoid conflict\n  const [formData, setFormData] = useState({\n    // ... (initial formData state)\n  });\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  // Use a regular function inside useEffect, or ensure useCallback's dependencies are perfect\n  useEffect(() => {\n    const fetchUserProfile = async () => {\n      if (!token) {\n        setLoading(false);\n        setError('Authentication token not found.');\n        return;\n      }\n      try {\n        const config = {\n          headers: {\n            Authorization: `Bearer ${token}`\n          }\n        };\n        const {\n          data\n        } = await axios.get('/api/auth/profile', config);\n        setFormData({\n          username: data.username || '',\n          email: data.email || '',\n          firstName: data.firstName || '',\n          lastName: data.lastName || '',\n          address: data.address || '',\n          city: data.city || '',\n          state: data.state || '',\n          zipCode: data.zipCode || '',\n          profilePictureUrl: data.profilePictureUrl || 'https://via.placeholder.com/150',\n          password: '',\n          confirmPassword: ''\n        });\n        setLoading(false);\n      } catch (err) {\n        console.error('Error fetching profile:', err);\n        const errorMessage = err.response && err.response.data.message ? err.response.data.message : err.message;\n        setError(`Failed to load profile: ${errorMessage}`);\n        toast.error(`Failed to load profile: ${errorMessage}`);\n        setLoading(false);\n      }\n    };\n    fetchUserProfile(); // Call the async function\n  }, [token]); // <-- Dependency array for useEffect. Only rerun when token changes.\n\n  // ... (handleChange and handleSubmit remain the same) ...\n}\n_s(ProfilePage, \"2w4uevzgV+SndvLycAesNTPr24w=\", false, function () {\n  return [useAuth];\n});\n_c = ProfilePage;\nexport default ProfilePage;\nvar _c;\n$RefreshReg$(_c, \"ProfilePage\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","axios","toast","useAuth","ProfilePage","_s","user","authUser","token","logout","formData","setFormData","loading","setLoading","error","setError","fetchUserProfile","config","headers","Authorization","data","get","username","email","firstName","lastName","address","city","state","zipCode","profilePictureUrl","password","confirmPassword","err","console","errorMessage","response","message","_c","$RefreshReg$"],"sources":["C:/Users/itach/Documents/book-exchange-mern/frontend/src/pages/ProfilePage.js"],"sourcesContent":["// frontend/src/pages/ProfilePage.js\r\nimport React, { useState, useEffect, useCallback } from 'react'; // Keep useCallback\r\nimport axios from 'axios';\r\nimport { toast } from 'react-toastify';\r\nimport { useAuth } from '../contexts/AuthContext';\r\nimport '../components/Form.css';\r\nimport '../App.css';\r\n\r\nfunction ProfilePage() {\r\n    const { user: authUser, token, logout } = useAuth(); // Renamed 'user' to 'authUser' to avoid conflict\r\n    const [formData, setFormData] = useState({\r\n        // ... (initial formData state)\r\n    });\r\n    const [loading, setLoading] = useState(true);\r\n    const [error, setError] = useState(null);\r\n\r\n    // Use a regular function inside useEffect, or ensure useCallback's dependencies are perfect\r\n    useEffect(() => {\r\n        const fetchUserProfile = async () => {\r\n            if (!token) {\r\n                setLoading(false);\r\n                setError('Authentication token not found.');\r\n                return;\r\n            }\r\n            try {\r\n                const config = {\r\n                    headers: {\r\n                        Authorization: `Bearer ${token}`,\r\n                    },\r\n                };\r\n                const { data } = await axios.get('/api/auth/profile', config);\r\n                setFormData({\r\n                    username: data.username || '',\r\n                    email: data.email || '',\r\n                    firstName: data.firstName || '',\r\n                    lastName: data.lastName || '',\r\n                    address: data.address || '',\r\n                    city: data.city || '',\r\n                    state: data.state || '',\r\n                    zipCode: data.zipCode || '',\r\n                    profilePictureUrl: data.profilePictureUrl || 'https://via.placeholder.com/150',\r\n                    password: '',\r\n                    confirmPassword: ''\r\n                });\r\n                setLoading(false);\r\n            } catch (err) {\r\n                console.error('Error fetching profile:', err);\r\n                const errorMessage = err.response && err.response.data.message\r\n                    ? err.response.data.message\r\n                    : err.message;\r\n                setError(`Failed to load profile: ${errorMessage}`);\r\n                toast.error(`Failed to load profile: ${errorMessage}`);\r\n                setLoading(false);\r\n            }\r\n        };\r\n\r\n        fetchUserProfile(); // Call the async function\r\n    }, [token]); // <-- Dependency array for useEffect. Only rerun when token changes.\r\n\r\n    // ... (handleChange and handleSubmit remain the same) ...\r\n\r\n    \r\n}\r\n\r\nexport default ProfilePage;"],"mappings":";AAAA;AACA,OAAOA,KAAK,IAAIC,QAAQ,EAAEC,SAAS,EAAEC,WAAW,QAAQ,OAAO,CAAC,CAAC;AACjE,OAAOC,KAAK,MAAM,OAAO;AACzB,SAASC,KAAK,QAAQ,gBAAgB;AACtC,SAASC,OAAO,QAAQ,yBAAyB;AACjD,OAAO,wBAAwB;AAC/B,OAAO,YAAY;AAEnB,SAASC,WAAWA,CAAA,EAAG;EAAAC,EAAA;EACnB,MAAM;IAAEC,IAAI,EAAEC,QAAQ;IAAEC,KAAK;IAAEC;EAAO,CAAC,GAAGN,OAAO,CAAC,CAAC,CAAC,CAAC;EACrD,MAAM,CAACO,QAAQ,EAAEC,WAAW,CAAC,GAAGb,QAAQ,CAAC;IACrC;EAAA,CACH,CAAC;EACF,MAAM,CAACc,OAAO,EAAEC,UAAU,CAAC,GAAGf,QAAQ,CAAC,IAAI,CAAC;EAC5C,MAAM,CAACgB,KAAK,EAAEC,QAAQ,CAAC,GAAGjB,QAAQ,CAAC,IAAI,CAAC;;EAExC;EACAC,SAAS,CAAC,MAAM;IACZ,MAAMiB,gBAAgB,GAAG,MAAAA,CAAA,KAAY;MACjC,IAAI,CAACR,KAAK,EAAE;QACRK,UAAU,CAAC,KAAK,CAAC;QACjBE,QAAQ,CAAC,iCAAiC,CAAC;QAC3C;MACJ;MACA,IAAI;QACA,MAAME,MAAM,GAAG;UACXC,OAAO,EAAE;YACLC,aAAa,EAAE,UAAUX,KAAK;UAClC;QACJ,CAAC;QACD,MAAM;UAAEY;QAAK,CAAC,GAAG,MAAMnB,KAAK,CAACoB,GAAG,CAAC,mBAAmB,EAAEJ,MAAM,CAAC;QAC7DN,WAAW,CAAC;UACRW,QAAQ,EAAEF,IAAI,CAACE,QAAQ,IAAI,EAAE;UAC7BC,KAAK,EAAEH,IAAI,CAACG,KAAK,IAAI,EAAE;UACvBC,SAAS,EAAEJ,IAAI,CAACI,SAAS,IAAI,EAAE;UAC/BC,QAAQ,EAAEL,IAAI,CAACK,QAAQ,IAAI,EAAE;UAC7BC,OAAO,EAAEN,IAAI,CAACM,OAAO,IAAI,EAAE;UAC3BC,IAAI,EAAEP,IAAI,CAACO,IAAI,IAAI,EAAE;UACrBC,KAAK,EAAER,IAAI,CAACQ,KAAK,IAAI,EAAE;UACvBC,OAAO,EAAET,IAAI,CAACS,OAAO,IAAI,EAAE;UAC3BC,iBAAiB,EAAEV,IAAI,CAACU,iBAAiB,IAAI,iCAAiC;UAC9EC,QAAQ,EAAE,EAAE;UACZC,eAAe,EAAE;QACrB,CAAC,CAAC;QACFnB,UAAU,CAAC,KAAK,CAAC;MACrB,CAAC,CAAC,OAAOoB,GAAG,EAAE;QACVC,OAAO,CAACpB,KAAK,CAAC,yBAAyB,EAAEmB,GAAG,CAAC;QAC7C,MAAME,YAAY,GAAGF,GAAG,CAACG,QAAQ,IAAIH,GAAG,CAACG,QAAQ,CAAChB,IAAI,CAACiB,OAAO,GACxDJ,GAAG,CAACG,QAAQ,CAAChB,IAAI,CAACiB,OAAO,GACzBJ,GAAG,CAACI,OAAO;QACjBtB,QAAQ,CAAC,2BAA2BoB,YAAY,EAAE,CAAC;QACnDjC,KAAK,CAACY,KAAK,CAAC,2BAA2BqB,YAAY,EAAE,CAAC;QACtDtB,UAAU,CAAC,KAAK,CAAC;MACrB;IACJ,CAAC;IAEDG,gBAAgB,CAAC,CAAC,CAAC,CAAC;EACxB,CAAC,EAAE,CAACR,KAAK,CAAC,CAAC,CAAC,CAAC;;EAEb;AAGJ;AAACH,EAAA,CAtDQD,WAAW;EAAA,QAC0BD,OAAO;AAAA;AAAAmC,EAAA,GAD5ClC,WAAW;AAwDpB,eAAeA,WAAW;AAAC,IAAAkC,EAAA;AAAAC,YAAA,CAAAD,EAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}